import os
import sys

#configfile: "scCT_snakemake_final/config/config.yaml"


rule all:
	input:
		expand("data/{sample}/bigwig/all_reads.bw",sample = [x for x in config['samples']])


rule bam_to_bw:
    input:
        lambda wildcards: config['samples'][wildcards.sample]['cellranger_out'] + '/outs/possorted_bam.bam'
    output:
        "data/{sample}/bigwig/all_reads.bw"
    threads: 8
    shell:
        "bamCoverage -b {input} -o {output} -p {threads} --minMappingQuality 5 "
        " --binSize 100 --centerReads --smoothLength 500 --normalizeUsing RPKM --ignoreDuplicates"